<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:Lumino.ViewModels"
             xmlns:controls="using:Lumino.Views.Controls"
             mc:Ignorable="d" d:DesignWidth="200" d:DesignHeight="600"
             x:Class="Lumino.Views.Controls.TrackSelector"
             x:DataType="vm:TrackSelectorViewModel">

    <UserControl.Styles>
        <!-- 音轨选择器样式 -->
        <Style Selector="Border.TrackSelector">
            <Setter Property="Background" Value="{DynamicResource ToolbarBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ToolbarBorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
        </Style>

        <!-- 标题栏样式 -->
        <Style Selector="Border.TrackSelectorHeader">
            <Setter Property="Background" Value="{DynamicResource ToolbarBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ToolbarBorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Height" Value="32"/>
        </Style>

        <!-- 滚动条样式 -->
        <Style Selector="ScrollViewer">
            <Setter Property="Background" Value="Transparent"/>
        </Style>
    </UserControl.Styles>

    <Border Classes="TrackSelector">
        <DockPanel>
            <!-- 标题栏 -->
            <Border DockPanel.Dock="Top" Classes="TrackSelectorHeader">
                <Grid Margin="8,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="音轨列表"
                               FontSize="12"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"
                               Foreground="{DynamicResource StatusTextBrush}"/>

                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <!-- 添加音轨按钮 -->
                        <Button Width="20" Height="20"
                                Padding="0"
                                Background="Transparent"
                                BorderThickness="1"
                                BorderBrush="{DynamicResource ButtonBorderBrush}"
                                CornerRadius="2"
                                Command="{Binding AddTrackCommand}"
                                ToolTip.Tip="添加音轨">
                            <TextBlock Text="+" FontSize="12" FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 音轨列表 -->
            <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                          VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding Tracks}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="vm:TrackViewModel">
                            <controls:TrackPanel DataContext="{Binding}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>
    </Border>
</UserControl>