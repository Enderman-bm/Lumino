<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Lumino.ViewModels.Settings"
        xmlns:models="using:Lumino.Models.Settings"
        xmlns:settingsViews="using:Lumino.Views.Settings"
        xmlns:converters="using:Lumino.Views.Converters"
        xmlns:controls="using:Avalonia.Controls"
        xmlns:localControls="using:Lumino.Views.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="700"
        x:Class="Lumino.Views.Settings.SettingsWindow"
        x:DataType="vm:SettingsWindowViewModel"
        Title="设置 - Lumino"
        Width="900" Height="700"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        Icon="/Assets/avalonia-logo.ico"
        FontFamily="Microsoft YaHei">

	<Window.Resources>
		<converters:ObjectEqualsConverter x:Key="ObjectEqualsConverter"/>
		<converters:MultiObjectEqualsConverter x:Key="MultiObjectEqualsConverter"/>
	</Window.Resources>

	<Window.Styles>
		<!-- 统一按钮基础样式 - Material Design -->
		<Style Selector="Button">
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="Background" Duration="0:0:0.15"/>
					<ThicknessTransition Property="BorderThickness" Duration="0:0:0.15"/>
				</Transitions>
			</Setter>
		</Style>

		<!-- 普通按钮样式 -->
		<Style Selector="Button:not(.SettingsNavButton)">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="#FF673AB7"/>
			<Setter Property="Foreground" Value="#FF673AB7"/>
			<Setter Property="Padding" Value="12,6"/>
			<Setter Property="CornerRadius" Value="4"/>
		</Style>

		<Style Selector="Button:not(.SettingsNavButton):pointerover">
			<Setter Property="Background" Value="#1A673AB7"/>
			<Setter Property="Foreground" Value="White"/>
		</Style>

		<Style Selector="Button:not(.SettingsNavButton):pressed">
			<Setter Property="Background" Value="#30673AB7"/>
			<Setter Property="Foreground" Value="White"/>
		</Style>

		<!-- CheckBox 样式 -->
		<Style Selector="CheckBox">
			<Setter Property="Margin" Value="0,4"/>
		</Style>

		<!-- RadioButton 样式 -->
		<Style Selector="RadioButton">
			<Setter Property="Margin" Value="0,4"/>
		</Style>
	</Window.Styles>

	<Design.DataContext>
		<vm:SettingsWindowViewModel/>
	</Design.DataContext>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- 主内容区域 -->
		<Grid Grid.Row="0">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="250"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<!-- 左侧导航 -->
			<Border Grid.Column="0"
                    Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                    BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                    BorderThickness="0,0,1,0">
				<ScrollViewer>
					<StackPanel Margin="10">
						<TextBlock Text="设置类别"
                                   FontWeight="Bold"
                                   FontSize="16"
                                   Margin="0,0,0,15"
                                   Foreground="#FF673AB7"/>

						<ItemsControl ItemsSource="{Binding Pages}">
							<ItemsControl.ItemTemplate>
								<DataTemplate DataType="models:SettingsPageInfo">
									<Button Classes="SettingsNavButton"
                                            Command="{Binding $parent[ItemsControl].DataContext.SelectPageCommand}"
                                            CommandParameter="{Binding Type}"
                                            HorizontalAlignment="Stretch"
                                            HorizontalContentAlignment="Left"
                                            Margin="0,2"
                                            Padding="12,8"
                                            CornerRadius="4"
                                            Background="Transparent"
                                            BorderThickness="0">
										<Button.Styles>
											<Style Selector="Button.SettingsNavButton">
												<Setter Property="Transitions">
													<Transitions>
														<BrushTransition Property="Background" Duration="0:0:0.15"/>
													</Transitions>
												</Setter>
											</Style>
											<Style Selector="Button.SettingsNavButton:pointerover">
												<Setter Property="Background" Value="#1A673AB7"/>
											</Style>
											<Style Selector="Button.SettingsNavButton:pressed">
												<Setter Property="Background" Value="#30673AB7"/>
											</Style>
										</Button.Styles>

										<StackPanel Orientation="Horizontal">
											<TextBlock Text="{Binding Icon}"
                                                       FontSize="16"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0"/>
											<StackPanel>
												<TextBlock Text="{Binding Title}"
                                                           FontWeight="Medium"/>
												<TextBlock Text="{Binding Description}"
                                                           FontSize="12"
                                                           Opacity="0.7"/>
											</StackPanel>
										</StackPanel>
									</Button>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</StackPanel>
				</ScrollViewer>
			</Border>

				<!-- 右侧内容区域 - 使用虚拟化 ScrollViewer 提高性能 -->
				<ScrollViewer Grid.Column="1" Padding="30,20" VerticalScrollBarVisibility="Auto">
					<StackPanel x:Name="SettingsContentPanel">
						<!-- 常规设置 -->
						<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.General}}">
							<TextBlock Text="常规设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
							<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

							<StackPanel Spacing="20">
							<!-- 自动保存 -->
							<StackPanel>
								<TextBlock Text="自动保存" FontWeight="Medium" Margin="0,0,0,8"/>
								<CheckBox Content="启用自动保存" IsChecked="{Binding Settings.AutoSave}"/>

								<StackPanel Orientation="Horizontal"
                                            Margin="0,8,0,0"
                                            IsVisible="{Binding Settings.AutoSave}">
									<TextBlock Text="保存间隔:" VerticalAlignment="Center" Margin="0,0,8,0"/>
									<NumericUpDown Value="{Binding Settings.AutoSaveInterval}"
                                                   Minimum="1" Maximum="60"
                                                   Width="80"
                                                   VerticalAlignment="Center"/>
									<TextBlock Text="分钟" VerticalAlignment="Center" Margin="8,0,0,0"/>
								</StackPanel>
							</StackPanel>

							<CheckBox Content="使用原生菜单栏" IsChecked="{Binding Settings.UseNativeMenuBar}"/>

							<StackPanel>
								<TextBlock Text="最大撤销步数" FontWeight="Medium" Margin="0,0,0,8"/>
								<NumericUpDown Value="{Binding Settings.MaxUndoSteps}"
                                               Minimum="10" Maximum="1000"
                                               Width="100"/>
							</StackPanel>

							<CheckBox Content="删除前确认" IsChecked="{Binding Settings.ConfirmBeforeDelete}"/>
						</StackPanel>
					</StackPanel>

				<!-- 语言设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Language}}">
					<TextBlock Text="语言设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="15">
							<TextBlock Text="选择界面语言:" FontWeight="Medium"/>

							<ItemsControl ItemsSource="{Binding LanguageOptions}" Margin="0,8,0,0">
								<ItemsControl.ItemTemplate>
									<DataTemplate DataType="models:LanguageOption">
										<RadioButton GroupName="Language"
                                                     Content="{Binding NativeName}"
                                                     Command="{Binding $parent[Window].DataContext.ApplyLanguageCommand}"
                                                     CommandParameter="{Binding Code}"
                                                     Margin="0,4">
											<RadioButton.IsChecked>
												<MultiBinding Converter="{StaticResource MultiObjectEqualsConverter}">
													<Binding Path="DataContext.SelectedLanguageCode" RelativeSource="{RelativeSource AncestorType=Window}"/>
													<Binding Path="Code"/>
												</MultiBinding>
											</RadioButton.IsChecked>
										</RadioButton>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>

							<TextBlock Text="注意：更改语言后需要重启应用程序才能完全生效。"
                                       FontStyle="Italic"
                                       Opacity="0.7"
                                       Margin="0,10,0,0"
                                       TextWrapping="Wrap"/>
						</StackPanel>
					</StackPanel>

				<!-- 主题设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Theme}}">
					<TextBlock Text="主题设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="15">
							<TextBlock Text="选择应用主题:" FontWeight="Medium"/>

							<ItemsControl ItemsSource="{Binding ThemeOptions}" Margin="0,8,0,0">
								<ItemsControl.ItemTemplate>
									<DataTemplate DataType="models:ThemeOption">
										<RadioButton GroupName="Theme"
                                                     Command="{Binding $parent[Window].DataContext.ApplyThemeCommand}"
                                                     CommandParameter="{Binding Key}"
                                                     Margin="0,8" 
                                                     VerticalAlignment="Center"
                                                     VerticalContentAlignment="Center">
											<RadioButton.IsChecked>
												<MultiBinding Converter="{StaticResource MultiObjectEqualsConverter}">
													<Binding Path="DataContext.SelectedThemeKey" RelativeSource="{RelativeSource AncestorType=Window}"/>
													<Binding Path="Key"/>
												</MultiBinding>
											</RadioButton.IsChecked>
											<StackPanel VerticalAlignment="Center">
												<TextBlock Text="{Binding Name}" FontWeight="Medium" VerticalAlignment="Center"/>
												<TextBlock Text="{Binding Description}"
                                                           FontSize="12"
                                                           Opacity="0.7"
                                                           VerticalAlignment="Center"/>
											</StackPanel>
										</RadioButton>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>

							<!-- 已移除自定义颜色设置面板（包括分组、预览、输入框、重置按钮等），如需恢复请参考历史版本。-->
						</StackPanel>
					</StackPanel>

				<!-- 编辑器设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Editor}}">
					<TextBlock Text="编辑器设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="20">
							<StackPanel>
								<TextBlock Text="网格和对齐" FontWeight="Medium" Margin="0,0,0,8"/>
								<CheckBox Content="显示网格线" IsChecked="{Binding Settings.ShowGridLines}"/>
								<CheckBox Content="启用网格对齐" IsChecked="{Binding Settings.SnapToGrid}" Margin="0,8,0,0"/>
							</StackPanel>

							<StackPanel>
								<TextBlock Text="显示选项" FontWeight="Medium" Margin="0,0,0,8"/>
								<CheckBox Content="显示力度条" IsChecked="{Binding Settings.ShowVelocityBars}"/>
							</StackPanel>

							<StackPanel>
								<TextBlock Text="默认缩放" FontWeight="Medium" Margin="0,0,0,8"/>
								<Slider Value="{Binding Settings.DefaultZoom}"
                                        Minimum="0.1" Maximum="5.0"
                                        TickFrequency="0.1"
                                        Width="200"
                                        HorizontalAlignment="Left"/>
								<TextBlock Text="{Binding Settings.DefaultZoom, StringFormat='{}{0:F1}x'}"
                                           Margin="0,4,0,0"/>
							</StackPanel>

							<StackPanel>
								<TextBlock Text="钢琴键宽度" FontWeight="Medium" Margin="0,0,0,8"/>
								<NumericUpDown Value="{Binding Settings.PianoKeyWidth}"
                                               Minimum="40" Maximum="120"
                                               Width="100"/>
							</StackPanel>
						</StackPanel>
					</StackPanel>

				<!-- 快捷键设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Shortcuts}}">
					<TextBlock Text="快捷键设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="15">
							<CheckBox Content="启用键盘快捷键" IsChecked="{Binding Settings.EnableKeyboardShortcuts}"/>

							<StackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0">
								<Button Content="重置所有快捷键" Command="{Binding ResetAllShortcutsCommand}"/>
							</StackPanel>

							<controls:DataGrid ItemsSource="{Binding ShortcutSettings}"
                                      AutoGenerateColumns="False"
                                      CanUserReorderColumns="False"
                                      CanUserResizeColumns="True"
                                      CanUserSortColumns="False"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      MinHeight="300"
                                      MaxHeight="400"
                                      VerticalAlignment="Stretch">
								<controls:DataGrid.Columns>
									<controls:DataGridTextColumn Header="类别" Binding="{Binding Category}" Width="80" IsReadOnly="True"/>
									<controls:DataGridTextColumn Header="命令" Binding="{Binding Description}" Width="150" IsReadOnly="True"/>
									<controls:DataGridTextColumn Header="快捷键" Binding="{Binding CurrentShortcut}" Width="120"/>
									<controls:DataGridTextColumn Header="默认" Binding="{Binding DefaultShortcut}" Width="120" IsReadOnly="True"/>
									<controls:DataGridTemplateColumn Header="操作" Width="80">
										<controls:DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<Button Content="重置"
                                                        Command="{Binding $parent[controls:DataGrid].DataContext.ResetShortcutCommand}"
                                                        CommandParameter="{Binding}"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Padding="4,2"/>
											</DataTemplate>
										</controls:DataGridTemplateColumn.CellTemplate>
									</controls:DataGridTemplateColumn>
								</controls:DataGrid.Columns>
							</controls:DataGrid>
						</StackPanel>
					</StackPanel>

				<!-- 高级设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Advanced}}">
					<TextBlock Text="高级设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="20">
							<TextBlock Text="调试和性能选项" FontWeight="Medium"/>

							<Button Content="重置所有设置"
                                    Command="{Binding ResetToDefaultsCommand}"
                                    HorizontalAlignment="Left"
                                    Background="Orange"
                                    Foreground="White"/>

							<TextBlock Text="警告：重置所有设置将恢复为默认值，此操作不可撤销。"
                                       FontStyle="Italic"
                                       Opacity="0.7"/>

							<StackPanel Orientation="Horizontal" Spacing="10" Margin="0,20,0,0">
								<Button Content="从文件加载设置"
                                        Click="LoadSettingsFromFile_Click"
                                        ToolTip.Tip="从配置文件重新加载设置"/>
								<Button Content="保存设置到文件"
                                        Click="SaveSettingsToFile_Click"
                                        ToolTip.Tip="将当前设置保存到配置文件"/>
							</StackPanel>
					</StackPanel>
				</StackPanel>

				<!-- 播表设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Audio}}">
					<TextBlock Text="播表设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="20">
						<!-- 播表引擎选择 -->
						<StackPanel>
							<TextBlock Text="播表引擎" FontWeight="Medium" Margin="0,0,0,8"/>
							<ItemsControl ItemsSource="{Binding WaveTableEngineOptions}" Margin="0,8,0,0">
								<ItemsControl.ItemTemplate>
									<DataTemplate DataType="models:WaveTableEngineOption">
										<RadioButton GroupName="WaveTableEngine"
													 Command="{Binding $parent[Window].DataContext.ApplyWaveTableEngineCommand}"
													 CommandParameter="{Binding Id}"
													 Margin="0,8"
													 VerticalAlignment="Center"
													 VerticalContentAlignment="Center"
													 IsEnabled="{Binding IsAvailable}">
											<RadioButton.IsChecked>
												<MultiBinding Converter="{StaticResource MultiObjectEqualsConverter}">
													<Binding Path="DataContext.SelectedWaveTableEngine" RelativeSource="{RelativeSource AncestorType=Window}"/>
													<Binding Path="Id"/>
												</MultiBinding>
											</RadioButton.IsChecked>
											<StackPanel VerticalAlignment="Center">
												<TextBlock Text="{Binding Name}" FontWeight="Medium" VerticalAlignment="Center"/>
												<TextBlock Text="{Binding Description}" FontSize="12" Opacity="0.7" VerticalAlignment="Center"/>
												<TextBlock Text="{Binding ErrorMessage}" FontSize="11" Foreground="#FFFF5252" IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" Margin="0,4,0,0"/>
											</StackPanel>
										</RadioButton>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</StackPanel>

						<!-- MIDI 设备选择 -->
						<StackPanel>
							<TextBlock Text="MIDI 输出设备" FontWeight="Medium" Margin="0,0,0,8"/>
							<ComboBox ItemsSource="{Binding AvailableMidiDevices}"
									  SelectedItem="{Binding SelectedMidiDevice}"
									  Margin="0,8,0,0">
								<ComboBox.ItemTemplate>
									<DataTemplate>
										<TextBlock Text="{Binding Name}"/>
									</DataTemplate>
								</ComboBox.ItemTemplate>
							</ComboBox>
							<TextBlock Text="选择用于播放 MIDI 的输出设备" FontSize="12" Opacity="0.6" Margin="0,4,0,0"/>
						</StackPanel>

						<!-- Lumino播表音色库选择 -->
						<StackPanel>
							<TextBlock Text="Lumino播表音色库 (仅在选择Lumino播表时有效)" FontWeight="Medium" Margin="0,0,0,8" Foreground="#FF673AB7"/>
							<ComboBox ItemsSource="{Binding AvailableSoundFonts}"
									  SelectedItem="{Binding SelectedSoundFont}"
									  Margin="0,8,0,0">
								<ComboBox.ItemTemplate>
									<DataTemplate>
										<StackPanel>
											<TextBlock Text="{Binding Name}" FontWeight="Medium"/>
											<TextBlock Text="{Binding Description}" FontSize="11" Opacity="0.7"/>
										</StackPanel>
									</DataTemplate>
								</ComboBox.ItemTemplate>
							</ComboBox>
							<TextBlock Text="支持格式: SF2, SF3, DLS, GIGA" FontSize="11" Opacity="0.6" Margin="0,4,0,0"/>
							<Button Content="浏览音色库文件..." 
									Classes="MaterialButton"
									Padding="12,6"
									Margin="0,8,0,0"
									ToolTip.Tip="选择本地音色库文件进行加载"/>
						</StackPanel>

						<!-- 自动检测 -->
						<StackPanel>
							<CheckBox Content="启用自动检测播表" IsChecked="{Binding IsWaveTableAutoDetectionEnabled}"/>
							<TextBlock Text="应用启动时自动检测可用的播表引擎" FontSize="12" Opacity="0.6" Margin="0,4,0,0"/>
						</StackPanel>

						<!-- 测试按钮 -->
						<StackPanel Orientation="Horizontal" Spacing="10" Margin="0,20,0,0">
							<Button Content="测试播放" 
									Padding="16,8"
									Classes="MaterialButton"
									Command="{Binding TestPlaybackCommand}"
									ToolTip.Tip="播放测试音符以验证播表是否正常工作"/>
							<Button Content="刷新设备列表"
									Padding="16,8"
									Classes="MaterialButton"
									ToolTip.Tip="重新扫描可用的 MIDI 输出设备"/>
						</StackPanel>

						<!-- 提示信息 -->
						<Border Background="#FFE3F2FD"
								BorderBrush="#FF2196F3"
								BorderThickness="1"
								CornerRadius="4"
								Padding="12"
								Margin="0,20,0,0">
							<StackPanel Spacing="8">
								<TextBlock Text="ℹ️ 提示信息" FontWeight="Medium" Foreground="#FF1976D2"/>
								<TextBlock Text="• 选择合适的播表引擎以获得最佳音质"
										   TextWrapping="Wrap"
										   FontSize="12"
										   Opacity="0.8"/>
								<TextBlock Text="• 某些播表引擎可能需要额外的驱动程序或软件支持"
										   TextWrapping="Wrap"
										   FontSize="12"
										   Opacity="0.8"/>
								<TextBlock Text="• 如果没有声音输出，请检查您的系统音频设置"
										   TextWrapping="Wrap"
										   FontSize="12"
										   Opacity="0.8"/>
							</StackPanel>
						</Border>
					</StackPanel>
				</StackPanel>

				<!-- 动画效果设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Animation}}">
					<TextBlock Text="动画效果设置" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="20">
						<!-- 动画模式选择 -->
						<StackPanel>
							<TextBlock Text="动画模式" FontWeight="Medium" Margin="0,0,0,8"/>
							<TextBlock Text="选择应用中的动画效果级别" FontSize="12" Opacity="0.6" Margin="0,0,0,12"/>
							
							<!-- 无动画模式 -->
							<RadioButton GroupName="AnimationMode"
										 IsChecked="{Binding SelectedAnimationMode, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:AnimationMode.None}}"
										 Command="{Binding ApplyAnimationModeCommand}"
										 CommandParameter="{x:Static models:AnimationMode.None}"
										 Margin="0,8">
								<StackPanel>
									<TextBlock Text="无动画" FontWeight="Medium"/>
									<TextBlock Text="禁用所有动画效果 (保留加载进度条)" FontSize="11" Opacity="0.7"/>
								</StackPanel>
							</RadioButton>

							<!-- 基础动画模式 -->
							<RadioButton GroupName="AnimationMode"
										 IsChecked="{Binding SelectedAnimationMode, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:AnimationMode.Basic}}"
										 Command="{Binding ApplyAnimationModeCommand}"
										 CommandParameter="{x:Static models:AnimationMode.Basic}"
										 Margin="0,8">
								<StackPanel>
									<TextBlock Text="基础动画" FontWeight="Medium"/>
									<TextBlock Text="仅启用按钮点击和悬停动画效果" FontSize="11" Opacity="0.7"/>
								</StackPanel>
							</RadioButton>

							<!-- 完整动画模式 (默认) -->
							<RadioButton GroupName="AnimationMode"
										 IsChecked="{Binding SelectedAnimationMode, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:AnimationMode.Full}}"
										 Command="{Binding ApplyAnimationModeCommand}"
										 CommandParameter="{x:Static models:AnimationMode.Full}"
										 Margin="0,8">
								<StackPanel>
									<TextBlock Text="完整动画 (默认)" FontWeight="Medium" Foreground="#FF673AB7"/>
									<TextBlock Text="启用所有动画效果: 按钮缩放、菜单滑行、音符预览平滑运动等" FontSize="11" Opacity="0.7"/>
								</StackPanel>
							</RadioButton>
						</StackPanel>

						<!-- 动画效果预览 -->
						<Border Background="#FFE3F2FD"
								BorderBrush="#FF2196F3"
								BorderThickness="1"
								CornerRadius="4"
								Padding="12">
							<StackPanel Spacing="8">
								<TextBlock Text="✨ 动画效果说明" FontWeight="Medium" Foreground="#FF1976D2"/>
								<TextBlock Text="无动画模式:" FontWeight="SemiBold" Margin="0,4,0,0"/>
								<TextBlock Text="• 界面响应速度最快，资源占用最少" FontSize="12" Opacity="0.8"/>
								
								<TextBlock Text="基础动画模式:" FontWeight="SemiBold" Margin="0,8,0,0"/>
								<TextBlock Text="• 按钮有悬停颜色变化和点击反馈" FontSize="12" Opacity="0.8"/>
								<TextBlock Text="• 轻量级过渡动画，适合性能较低的设备" FontSize="12" Opacity="0.8"/>
								
								<TextBlock Text="完整动画模式:" FontWeight="SemiBold" Margin="0,8,0,0"/>
								<TextBlock Text="• 音符预览框随鼠标位置平滑运动" FontSize="12" Opacity="0.8"/>
								<TextBlock Text="• 下拉菜单有向下/向上滑行效果" FontSize="12" Opacity="0.8"/>
								<TextBlock Text="• 按钮点击有缩小后回弹效果 (Material Design)" FontSize="12" Opacity="0.8"/>
								<TextBlock Text="• 提供最佳的用户体验" FontSize="12" Opacity="0.8"/>
							</StackPanel>
						</Border>

						<!-- 应用提示 -->
						<Border Background="#FFF3E5F5"
								BorderBrush="#FF9C27B0"
								BorderThickness="1"
								CornerRadius="4"
								Padding="12">
							<StackPanel Spacing="8">
								<TextBlock Text="⚙️ 提示" FontWeight="Medium" Foreground="#FF7B1FA2"/>
								<TextBlock Text="大多数更改将在应用重启后生效。某些动画效果可能需要具有硬件加速支持的现代GPU。" 
										   TextWrapping="Wrap"
										   FontSize="12"
										   Opacity="0.8"/>
							</StackPanel>
						</Border>
					</StackPanel>
				</StackPanel>

				<!-- 图形设置 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.Graphics}}">
					<settingsViews:GraphicsSettingsView DataContext="{Binding GraphicsSettingsViewModel}"/>
				</StackPanel>

				<!-- 关于 -->
				<StackPanel IsVisible="{Binding SelectedPageType, Converter={StaticResource ObjectEqualsConverter}, ConverterParameter={x:Static models:SettingsPageType.About}}">
					<TextBlock Text="关于 Lumino" FontSize="24" FontWeight="Bold" Margin="0,0,0,8" Foreground="#FF673AB7"/>
					<Rectangle Height="2" Fill="#FF673AB7" Margin="0,0,0,20" Width="80"/>

					<StackPanel Spacing="20">
							<!-- 项目信息 -->
							<Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
									BorderThickness="1"
									CornerRadius="12"
									Padding="30">
								<StackPanel HorizontalAlignment="Center" Spacing="20">
									<!-- Logo -->
									<Image Source="/Assets/avalonia-logo.ico"
										   Width="80" Height="80"
										   HorizontalAlignment="Center"/>

									<!-- 项目名称和版本 -->
									<StackPanel HorizontalAlignment="Center" Spacing="5">
										<TextBlock Text="Lumino"
												   FontSize="28"
												   FontWeight="Bold"
												   HorizontalAlignment="Center"/>
										<TextBlock Text="{Binding AboutViewModel.Version}"
												   FontSize="16"
												   Opacity="0.7"
												   HorizontalAlignment="Center"/>
									</StackPanel>

									<!-- 项目描述 -->
									<TextBlock Text="专业的MIDI编辑器，为音乐创作提供强大的钢琴卷帘功能"
											   TextWrapping="Wrap"
											   TextAlignment="Center"
											   FontSize="14"
											   Opacity="0.8"
											   MaxWidth="400"/>
								</StackPanel>
							</Border>

							<!-- 贡献者列表 -->
							<StackPanel Spacing="15">
								<StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
									<TextBlock Text="贡献者" FontSize="18" FontWeight="Medium"/>
									<Button Content="刷新"
											Command="{Binding AboutViewModel.RefreshContributorsCommand}"
											IsEnabled="{Binding !AboutViewModel.IsLoadingContributors}"
											Padding="12,6"
											HorizontalAlignment="Right"/>
								</StackPanel>

								<!-- 加载状态 -->
								<StackPanel IsVisible="{Binding AboutViewModel.IsLoadingContributors}"
											HorizontalAlignment="Center"
											Margin="0,20">
									<ProgressBar IsIndeterminate="True" Width="200"/>
									<TextBlock Text="正在加载贡献者信息..."
											   HorizontalAlignment="Center"
											   Margin="0,10,0,0"
											   Opacity="0.7"/>
								</StackPanel>

								<!-- 错误信息 -->
								<Border IsVisible="{Binding AboutViewModel.ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
										Background="{DynamicResource SystemControlErrorTextForegroundBrush}"
										BorderThickness="1"
										CornerRadius="4"
										Padding="15"
										Margin="0,10">
									<TextBlock Text="{Binding AboutViewModel.ErrorMessage}"
											   Foreground="White"
											   TextWrapping="Wrap"/>
								</Border>

								<!-- 贡献者网格 -->
								<ItemsControl ItemsSource="{Binding AboutViewModel.Contributors}"
											  IsVisible="{Binding !AboutViewModel.IsLoadingContributors}">
									<ItemsControl.ItemsPanel>
										<ItemsPanelTemplate>
											<WrapPanel Orientation="Horizontal" HorizontalAlignment="Center"/>
										</ItemsPanelTemplate>
									</ItemsControl.ItemsPanel>
									<ItemsControl.ItemTemplate>
										<DataTemplate DataType="vm:Contributor">
											<Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
													BorderThickness="1"
													CornerRadius="8"
													Padding="12"
													Margin="4"
													Width="120">
												<StackPanel HorizontalAlignment="Center" Spacing="8">
													<!-- 头像 -->
													<Image Source="{Binding AvatarUrl}"
														   Width="48" Height="48"
														   HorizontalAlignment="Center">
														<Image.Styles>
															<Style Selector="Image">
																<Setter Property="Clip">
																	<EllipseGeometry Rect="0,0,48,48"/>
																</Setter>
															</Style>
														</Image.Styles>
													</Image>

													<!-- 姓名 -->
													<TextBlock Text="{Binding Name}"
															   FontWeight="Medium"
															   FontSize="12"
															   TextAlignment="Center"
															   TextWrapping="Wrap"
															   MaxWidth="100"/>

													<!-- 贡献次数 -->
													<TextBlock Text="{Binding Contributions, StringFormat='{}{0} 次贡献'}"
															   FontSize="10"
															   Opacity="0.6"
															   TextAlignment="Center"/>
												</StackPanel>
											</Border>
										</DataTemplate>
									</ItemsControl.ItemTemplate>
								</ItemsControl>
							</StackPanel>
						</StackPanel>
					</StackPanel>
				</StackPanel>
			</ScrollViewer>
		</Grid>
	</Grid>
</Window>