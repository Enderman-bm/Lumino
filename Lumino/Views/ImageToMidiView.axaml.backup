<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Lumino.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="700"
        x:Class="Lumino.Views.ImageToMidiView"
        x:DataType="vm:ImageToMidiViewModel"
        Title="ImageToMidi - å›¾ç‰‡è½¬MIDIå·¥å…·"
        Width="900" Height="700"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterOwner"
        Icon="/Assets/avalonia-logo.ico">

	<Window.Styles>
		<!-- ç»Ÿä¸€æŒ‰é’®åŸºç¡€æ ·å¼ - Material Design -->
		<Style Selector="Button">
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="Background" Duration="0:0:0.15"/>
					<ThicknessTransition Property="BorderThickness" Duration="0:0:0.15"/>
				</Transitions>
			</Setter>
		</Style>

		<!-- å·¥å…·æ æŒ‰é’®æ ·å¼ -->
		<Style Selector="Button.ToolbarButton">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="#FF673AB7"/>
			<Setter Property="Foreground" Color="#FF673AB7"/>
			<Setter Property="Padding" Value="12,8"/>
			<Setter Property="Margin" Value="4"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="MinWidth" Value="100"/>
		</Style>

		<Style Selector="Button.ToolbarButton:pointerover">
			<Setter Property="Background" Value="#1A673AB7"/>
			<Setter Property="Foreground" Color="White"/>
		</Style>

		<Style Selector="Button.ToolbarButton:pressed">
			<Setter Property="Background" Value="#30673AB7"/>
			<Setter Property="Foreground" Color="White"/>
			<Setter Property="RenderTransform" Value="scale(0.96)"/>
		</Style>

		<!-- çŠ¶æ€æ æ–‡æœ¬ -->
		<Style Selector="TextBlock.StatusText">
			<Setter Property="FontSize" Value="12"/>
			<Setter Property="Foreground" Value="#FF673AB7"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
			<Setter Property="Margin" Value="8,0"/>
		</Style>

		<!-- ä¿¡æ¯æ–‡æœ¬ -->
		<Style Selector="TextBlock.InfoText">
			<Setter Property="FontSize" Value="11"/>
			<Setter Property="Foreground" Value="#666666"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
			<Setter Property="Margin" Value="8,0"/>
		</Style>

		<!-- å›¾ç‰‡å®¹å™¨è¾¹æ¡† -->
		<Style Selector="Border.ImageContainer">
			<Setter Property="BorderBrush" Value="#E0E0E0"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Background" Value="White"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="Padding" Value="8"/>
		</Style>
	</Window.Styles>

	<Grid RowDefinitions="Auto,*,Auto">
		<!-- å·¥å…·æ  -->
		<ToolBar Grid.Row="0" Height="50" Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
			<Button Classes="ToolbarButton"
			        Command="{Binding LoadImageCommand}"
			        IsEnabled="{Binding !IsProcessing}">
				<TextBlock Text="ðŸ“ åŠ è½½å›¾ç‰‡"/>
			</Button>

			<Separator/>

			<Button Classes="ToolbarButton"
			        Command="{Binding ConvertCommand}"
			        IsEnabled="{Binding IsConvertEnabled}">
				<TextBlock Text="ðŸ”„ å¼€å§‹è½¬æ¢"/>
			</Button>

			<Separator/>

			<Button Classes="ToolbarButton"
			        Command="{Binding CloseCommand}">
				<TextBlock Text="âŒ å…³é—­"/>
			</Button>
		</ToolBar>

		<!-- ä¸»å†…å®¹åŒºåŸŸ -->
		<Grid Grid.Row="1" Margin="16">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<!-- é…ç½®é¢æ¿ -->
			<Border Grid.Row="0" Background="White"
			        BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="4"
			        Padding="16" Margin="0,0,0,12">
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>

					<TextBlock Grid.Row="0" Grid.Column="0" Text="è¾“å‡ºç›®å½•:" VerticalAlignment="Center" Margin="0,0,16,8"/>
					<TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Config.OutputDirectory}" Watermark="è¾“å‡ºMIDIæ–‡ä»¶çš„ç›®å½•" Margin="0,0,0,8"/>

					<TextBlock Grid.Row="1" Grid.Column="0" Text="æ–‡ä»¶åæ ¼å¼:" VerticalAlignment="Center" Margin="0,0,16,8"/>
					<TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Config.OutputFileNameFormat}" Watermark="MIDIæ–‡ä»¶åæ ¼å¼" Margin="0,0,0,8"/>

					<TextBlock Grid.Row="2" Grid.Column="0" Text="é›†ç¾¤ç®—æ³•:" VerticalAlignment="Center" Margin="0,0,16,8"/>
					<ComboBox Grid.Row="2" Grid.Column="1" SelectedIndex="{Binding Config.ClusterAlgorithm}"
					          Margin="0,0,0,8">
						<ComboBoxItem Content="KMeans"/>
						<ComboBoxItem Content="KMeans++"/>
						<ComboBoxItem Content="å…«å‰æ ‘"/>
						<ComboBoxItem Content=" OPTICS"/>
						<ComboBoxItem Content="å±‚æ¬¡èšç±»"/>
						<ComboBoxItem Content="å…‰è°±èšç±»"/>
					</ComboBox>

					<TextBlock Grid.Row="3" Grid.Column="0" Text="é¢œè‰²æ•°:" VerticalAlignment="Center" Margin="0,0,16,8"/>
					<NumericUpDown Grid.Row="3" Grid.Column="1" Value="{Binding Config.ColorCount}"
					               Minimum="2" Maximum="256" Margin="0,0,0,8"/>

					<TextBlock Grid.Row="4" Grid.Column="0" Text="è¾“å‡ºé€‰é¡¹:" VerticalAlignment="Center" Margin="0,0,16,8"/>
					<StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
						<CheckBox Content="ä½¿ç”¨é¢œè‰²ID" IsChecked="{Binding Config.OutputToIndividualNotes}" Margin="0,0,16,0"/>
						<CheckBox Content="åž‚ç›´/æ°´å¹³ç¿»è½¬" IsChecked="{Binding Config.Flip}" Margin="0,0,16,0"/>
						<CheckBox Content="ç”Ÿæˆè¿žéŸ³" IsChecked="{Binding Config.GeneratingSlurs}" Margin="0,0,16,0"/>
					</StackPanel>
				</Grid>
			</Border>

			<!-- å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ -->
			<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
				<Border Classes="ImageContainer">
					<Grid>
						<Image Source="{Binding CurrentImage}"
						       HorizontalAlignment="Center"
						       VerticalAlignment="Center"
						       Stretch="Uniform"/>

						<!-- æ— å›¾ç‰‡æ—¶çš„å ä½ç¬¦ -->
						<Border IsVisible="{Binding CurrentImage, Converter={x:Static ObjectConverters.IsNull}}"
						        Background="#F5F5F5" CornerRadius="4">
							<StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
								<TextBlock Text="ðŸ–¼"
								           FontSize="64"
								           Foreground="#CCCCCC"
								           HorizontalAlignment="Center"/>
								<TextBlock Text="è¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åŠ è½½å›¾ç‰‡"
								           FontSize="16"
								           Foreground="#999999"
								           HorizontalAlignment="Center"
								           Margin="0,16,0,0"/>
							</StackPanel>
						</Border>
					</Grid>
				</Border>
			</ScrollViewer>
		</Grid>

		<!-- çŠ¶æ€æ  -->
		<StatusBar Grid.Row="2" Height="30" Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
			<StatusBarItem>
				<TextBlock Text="{Binding StatusMessage}" Classes="StatusText"/>
			</StatusBarItem>
			<StatusBarItem>
				<TextBlock Text="{Binding ImageInfo}" Classes="InfoText"/>
			</StatusBarItem>
			<StatusBarItem HorizontalAlignment="Right">
				<TextBlock Text="{Binding ProgressText}" Classes="InfoText"/>
			</StatusBarItem>
		</StatusBar>
	</Grid>
</Window>
