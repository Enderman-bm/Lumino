<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Lumino.ViewModels"
        xmlns:views="using:Lumino.Views"
        xmlns:controls="using:Lumino.Views.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="using:Lumino.Views.Converters"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="Lumino.Views.MainWindow"
        x:Name="RootWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Lumino - MIDI Editor"
        Width="1200" Height="800"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="True"
        CanResize="True">

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<Window.Styles>
		<!-- è§†å›¾é€‰æ‹©æŒ‰é’®æ ·å¼ - ä¸ŽPianoRollå·¥å…·æŒ‰é’®ä¿æŒä¸€è‡´ -->
		<Style Selector="Button.ViewButton">
			<Setter Property="Width" Value="32"/>
			<Setter Property="Height" Value="32"/>
			<Setter Property="Margin" Value="2"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="{DynamicResource ButtonBorderBrush}"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
		</Style>

		<Style Selector="Button.ViewButton:pointerover">
			<Setter Property="Background" Value="{DynamicResource ButtonHoverBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource ButtonActiveBrush}"/>
		</Style>

		<Style Selector="Button.ViewButton:pressed">
			<Setter Property="Background" Value="{DynamicResource ButtonPressedBrush}"/>
		</Style>

		<Style Selector="Button.ViewButton.active">
			<Setter Property="Background" Value="{DynamicResource ButtonActiveBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource SliderThumbPressedBrush}"/>
		</Style>

		<Style Selector="Button.ViewButton TextBlock">
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="HorizontalAlignment" Value="Center"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
		</Style>
	</Window.Styles>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- ä¸»èœå• -->
		<Menu Grid.Row="0">
			<MenuItem Header="æ–‡ä»¶">
				<MenuItem Header="æ–°å»º" Command="{Binding NewFileCommand}"/>
				<MenuItem Header="æ‰“å¼€" Command="{Binding OpenFileCommand}"/>
				<MenuItem Header="ä¿å­˜" Command="{Binding SaveFileCommand}"/>
				<Separator/>
				<MenuItem Header="å¯¼å…¥MIDI" Command="{Binding ImportMidiFileCommand}"/>
				<Separator/>
				<MenuItem Header="è®¾ç½®" Command="{Binding OpenSettingsCommand}"/>
				<Separator/>
				<MenuItem Header="é€€å‡º" Command="{Binding ExitApplicationCommand}"/>
			</MenuItem>
			<MenuItem Header="ç¼–è¾‘">
				<MenuItem Header="å…¨é€‰" Command="{Binding SelectAllCommand}"/>
				<MenuItem Header="å–æ¶ˆé€‰æ‹©" Command="{Binding DeselectAllCommand}"/>
			</MenuItem>
			<MenuItem Header="è§†å›¾">
				<MenuItem Header="æ”¾å¤§" Command="{Binding ZoomInCommand}" IsEnabled="{Binding CanZoomIn}"/>
				<MenuItem Header="ç¼©å°" Command="{Binding ZoomOutCommand}" IsEnabled="{Binding CanZoomOut}"/>
				<Separator/>
				<MenuItem Header="é€‚åº”çª—å£" Command="{Binding FitToWindowCommand}"/>
				<MenuItem Header="é‡ç½®ç¼©æ”¾" Command="{Binding ResetZoomCommand}"/>
			</MenuItem>
		</Menu>

		<!-- ä¸»å·¥ä½œåŒº -->
		<DockPanel Grid.Row="1">
			<!-- è§†å›¾é€‰æ‹©é¢æ¿ (å·¦ä¾§) -->
			<Border DockPanel.Dock="Left"
                    Width="48"
                    Background="{DynamicResource ToolbarBackgroundBrush}"
                    BorderBrush="{DynamicResource ToolbarBorderBrush}"
                    BorderThickness="0,0,1,0">
				<StackPanel Margin="6 8 6 8" VerticalAlignment="Top">
					<!-- é’¢ç´å·å¸˜è§†å›¾æŒ‰é’® -->
					<Button Classes="ViewButton"
							Classes.active="{Binding CurrentView, Converter={x:Static converters:ObjectEqualsConverter.Instance}, ConverterParameter={x:Static vm:ViewType.PianoRoll}}"
							Command="{Binding SelectViewCommand}"
							CommandParameter="{x:Static vm:ViewType.PianoRoll}"
							ToolTip.Tip="é’¢ç´å·å¸˜è§†å›¾">
						<TextBlock Text="ðŸŽ¹"/>
					</Button>

					<!-- æ€»è½¨è§†å›¾æŒ‰é’®ï¼ˆé¢„ç•™ï¼‰ -->
					<Button Classes="ViewButton"
							Classes.active="{Binding CurrentView, Converter={x:Static converters:ObjectEqualsConverter.Instance}, ConverterParameter={x:Static vm:ViewType.EventList}}"
							Command="{Binding SelectViewCommand}"
							CommandParameter="{x:Static vm:ViewType.EventList}"
							ToolTip.Tip="äº‹ä»¶åˆ—è¡¨"
							IsEnabled="True">
						<TextBlock Text="ðŸ“‹"/>
					</Button>
				</StackPanel>
			</Border>

			<!-- éŸ³è½¨é€‰æ‹©æŽ§ä»¶ -->
			<controls:TrackSelector DockPanel.Dock="Left" 
								Width="200"
								DataContext="{Binding TrackSelector}"/>

			<!-- ä¸»å†…å®¹åŒºåŸŸ -->
			<Grid>
				<!-- é’¢ç´å·å¸˜è§†å›¾ -->
				<views:PianoRollView DataContext="{Binding PianoRoll}"
									IsVisible="{Binding #RootWindow.DataContext.CurrentView, Converter={x:Static converters:IsNotTrackOverviewConverter.Instance}}"/>
				
				<!-- æ€»è½¨è§†å›¾ï¼ˆé¢„ç•™ï¼‰ -->
				<Border Background="{DynamicResource MainCanvasBackgroundBrush}"
						IsVisible="{Binding #RootWindow.DataContext.CurrentView, Converter={x:Static converters:ObjectEqualsConverter.Instance}, ConverterParameter={x:Static vm:ViewType.TrackOverview}}">
					<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
						<TextBlock Text="ðŸ“Š" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
						<TextBlock Text="æ€»è½¨è§†å›¾" FontSize="20" HorizontalAlignment="Center" Margin="0,0,0,8"
								   Foreground="{DynamicResource StatusTextBrush}"/>
						<TextBlock Text="æ­¤åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…..." FontSize="12" HorizontalAlignment="Center"
								   Foreground="{DynamicResource StatusTextBrush}" Opacity="0.7"/>
					</StackPanel>
				</Border>
			</Grid>
		</DockPanel>
	</Grid>
</Window>